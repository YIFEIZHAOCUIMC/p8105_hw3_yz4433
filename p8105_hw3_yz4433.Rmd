---
title: "p8105_hw3_yz4433"
author: "Yifei Zhao"
date: "2022-10-13"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(stringr)
```

## Problem 2
### Manipulate data
```{r}
data_acc = read_csv(file = "./data/accel_data.csv") %>% 
  janitor::clean_names() %>% 
  add_column(group = "days", .after = "day") %>% 
  mutate(group = ifelse((day == "Saturday" | day == "Sunday"), 'weekend', 'weekday'))
```

### Table showing totals
```{r}
data_acc = data_acc %>%
  add_column(total = rowSums(data_acc[,5:50]), .after = "group")
knitr::kable(data_acc[, 1:5], "simple")
```

```{r}
data_acc = data_acc[,-5] %>% 
  pivot_longer(
    activity_1:activity_1440,
    names_to = "activity", 
    values_to = "act_counts") %>%
  mutate(activity = substr(activity, 10, 13))
```

### Activity plot
```{r}
ggplot(data_acc, aes(x = activity, y = act_counts)) + 
  geom_point(aes(color = day), size = 1, alpha = 0.5) +
  scale_x_discrete(breaks = seq(0, 1440, 60)) +
  theme(axis.text.x = element_text(angle = 90))
```

